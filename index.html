<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทู - ุจูุงุจุฉ ุงููุจูู ูุงูุชุณุฌูู</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --forest-green: #006837;
            --gold: #D4AF37;
            --light-gray: #f5f5f5;
        }
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        body {
            background-color: #f9f9f9;
        }
        
        .step {
            display: none;
        }
        
        .step.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--forest-green);
            transition: width 0.5s ease-in-out;
        }
        
        .specialty-card {
            transition: all 0.3s ease;
            border: 2px solid #e5e7eb;
        }
        
        .specialty-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .specialty-card.selected {
            border-color: var(--forest-green);
            background-color: rgba(0, 104, 55, 0.05);
        }
        
        .fee-sidebar {
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .glow-border {
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        
        .required-field::after {
            content: " *";
            color: red;
        }
        
        .university-header {
            background: linear-gradient(135deg, var(--forest-green) 0%, #004d27 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .university-header::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23D4AF37' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
        }
        
        .social-icon {
            width: 36px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .social-icon:hover {
            transform: translateY(-3px);
        }
        
        /* ุชุญุณููุงุช ุงูุชุฎุตุตุงุช ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ */
        .specialty-card-step2 {
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .specialty-card-step2:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .specialty-card-step2.selected {
            border: 2px solid var(--forest-green) !important;
            background-color: rgba(0, 104, 55, 0.1) !important;
            transform: scale(0.98);
        }
        
        @keyframes pulse-select {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        /* ุชุญุณููุงุช ุงูุชุฌุงูุจ ููุดุงุดุงุช ุงูุตุบูุฑุฉ */
        @media (max-width: 768px) {
            .fee-sidebar {
                position: static;
                width: 100%;
                margin-top: 2rem;
            }
            
            .progress-bar {
                margin: 0 1rem;
            }
            
            .text-center.w-1\/4 .w-10 {
                width: 8px;
                height: 8px;
                font-size: 0.7rem;
                padding: 0.5rem;
            }
            
            .text-center.w-1\/4 p {
                font-size: 0.7rem;
            }
            
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .university-header h1 {
                font-size: 1.5rem;
            }
            
            .university-header h2 {
                font-size: 1.2rem;
            }
            
            .specialty-card {
                padding: 1.5rem !important;
            }
            
            .specialty-card .text-4xl {
                font-size: 2.5rem;
            }
            
            .specialty-card-step2 {
                min-height: 80px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                -webkit-tap-highlight-color: transparent;
            }
            
            .specialty-card-step2.selected {
                transform: scale(0.98);
                box-shadow: 0 5px 15px rgba(0, 104, 55, 0.2);
                animation: pulse-select 0.5s ease;
            }
            
            .specialty-card-step2:active {
                transform: scale(0.95);
                transition: transform 0.1s;
            }
        }
        
        @media (max-width: 480px) {
            .grid-cols-1 {
                grid-template-columns: 1fr !important;
            }
            
            .md\:grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            .md\:grid-cols-3 {
                grid-template-columns: 1fr !important;
            }
            
            .text-2xl, .text-3xl {
                font-size: 1.5rem;
            }
            
            .text-xl {
                font-size: 1.3rem;
            }
            
            .text-lg {
                font-size: 1.1rem;
            }
            
            .px-8 {
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
            
            .py-3 {
                padding-top: 0.75rem;
                padding-bottom: 0.75rem;
            }
            
            .w-32 {
                width: 6rem;
            }
        }
        
        @media (max-width: 360px) {
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .university-header h1 {
                font-size: 1.3rem;
            }
            
            .university-header h2 {
                font-size: 1rem;
            }
            
            .specialty-card {
                padding: 1rem !important;
            }
            
            .specialty-card .text-4xl {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- Header -->
    <header class="university-header py-4 md:py-6 px-4">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center relative z-10">
            <div class="text-center md:text-right mb-3 md:mb-0">
                <h1 class="text-xl md:text-3xl font-bold mb-1 md:mb-2">ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทู</h1>
                <h2 class="text-lg md:text-2xl font-semibold text-yellow-100">ุจูุงุจุฉ ุงููุจูู ูุงูุชุณุฌูู</h2>
            </div>
            <div class="text-center md:text-left">
                <p class="text-base md:text-lg text-yellow-100">ุงูุงูุชุญุงู ุจุงูุนุงู ุงูุฏุฑุงุณู 2025</p>
                <p class="text-xs md:text-sm text-gray-200 mt-1">ุงุจุฏุฃ ุฑุญูุชู ุงูุฃูุงุฏูููุฉ ูุนูุง</p>
            </div>
        </div>
    </header>

    <main class="container mx-auto py-4 md:py-6 px-3 md:px-4">
        <!-- Progress Steps -->
        <div class="mb-6 md:mb-10">
            <div class="flex justify-between items-center mb-3 md:mb-4">
                <div class="text-center w-1/4">
                    <div class="w-8 h-8 md:w-10 md:h-10 mx-auto rounded-full flex items-center justify-center mb-1 md:mb-2 bg-green-700 text-white font-bold text-sm md:text-base">ูก</div>
                    <p class="text-xs md:text-sm font-medium">ุชุญุฏูุฏ ุงููุณุงุฑ</p>
                </div>
                <div class="text-center w-1/4">
                    <div class="w-8 h-8 md:w-10 md:h-10 mx-auto rounded-full flex items-center justify-center mb-1 md:mb-2 bg-gray-300 text-gray-700 font-bold text-sm md:text-base">ูข</div>
                    <p class="text-xs md:text-sm font-medium text-gray-500">ุงูุจูุงูุงุช ุงูุฃูุงุฏูููุฉ</p>
                </div>
                <div class="text-center w-1/4">
                    <div class="w-8 h-8 md:w-10 md:h-10 mx-auto rounded-full flex items-center justify-center mb-1 md:mb-2 bg-gray-300 text-gray-700 font-bold text-sm md:text-base">ูฃ</div>
                    <p class="text-xs md:text-sm font-medium text-gray-500">ุงุฎุชูุงุฑ ุงูุชุฎุตุต</p>
                </div>
                <div class="text-center w-1/4">
                    <div class="w-8 h-8 md:w-10 md:h-10 mx-auto rounded-full flex items-center justify-center mb-1 md:mb-2 bg-gray-300 text-gray-700 font-bold text-sm md:text-base">ูค</div>
                    <p class="text-xs md:text-sm font-medium text-gray-500">ูุฑุงุฌุนุฉ ูุฅุฑุณุงู</p>
                </div>
            </div>
            <div class="progress-bar mx-2 md:mx-0">
                <div class="progress-fill" id="progressFill" style="width: 25%"></div>
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-4 md:gap-8">
            <!-- Main Form Content -->
            <div class="lg:w-2/3">
                <!-- Form for Web3Forms submission -->
                <form id="admissionForm" action="https://api.web3forms.com/submit" method="POST" class="hidden">
                    <input type="hidden" name="access_key" value="8f907260-fc10-46e0-b5b6-422b56f45c19">
                    <input type="hidden" name="subject" value="ุทูุจ ุฌุฏูุฏ - ุจูุงุจุฉ ุงููุจูู ูุงูุชุณุฌูู ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทู">
                    <input type="hidden" name="from_name" value="ุจูุงุจุฉ ุงููุจูู ูุงูุชุณุฌูู">
                    
                    <!-- Hidden fields for form data -->
                    <input type="hidden" name="ูุณุงุฑ_ุงููุจูู" id="formPath">
                    <input type="hidden" name="ุงูุชุฎุตุต" id="formSpecialty">
                    <input type="hidden" name="ููุน_ุงูุฏุฑุงุณุฉ" id="formStudyType">
                    <input type="hidden" name="ุนุฏุฏ_ุงูุณุงุนุงุช" id="formCreditHours">
                    <input type="hidden" name="ุงููุนุฏู_ุงูุชุฑุงููู" id="formGPA">
                    <input type="hidden" name="ุฏุฑุฌุฉ_ุงููุฏุฑุงุช" id="formAptitude">
                    <input type="hidden" name="ุฏุฑุฌุฉ_ุงูุชุญุตููู" id="formAchievement">
                    <input type="hidden" name="ุฏุฑุฌุฉ_ุงููุบุฉ" id="formEnglish">
                    <input type="hidden" name="ุณูุฉ_ุงูุชุฎุฑุฌ" id="formGraduationYear">
                    <input type="hidden" name="ููุน_ุงูุดูุงุฏุฉ" id="formCertificateType">
                    <input type="hidden" name="ุงูุงุณู_ุงูุฑุจุงุนู" id="formFullName">
                    <input type="hidden" name="ุฑูู_ุงููููุฉ" id="formNationalId">
                    <input type="hidden" name="ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู" id="formEmail">
                    <input type="hidden" name="ุฑูู_ุงูุฌูุงู" id="formPhone">
                    <input type="hidden" name="ุงูุฌูุณูุฉ" id="formNationality">
                    
                    <!-- Bridging fields (conditionally required) -->
                    <input type="hidden" name="ุชุฎุตุต_ุงูุฏุจููู" id="formDiplomaMajor">
                    <input type="hidden" name="ุดูุงุฏุฉ_ุงูุฏุจููู" id="formDiplomaCertificate">
                    
                    <input type="hidden" name="redirect" value="false">
                    <input type="checkbox" name="botcheck" class="hidden" style="display: none;">
                </form>

                <!-- Step 1: ุชุญุฏูุฏ ุงููุณุงุฑ -->
                <div id="step1" class="step active">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6 glow-border">
                        <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4 pb-2 border-b border-yellow-200">ุงููุฑุญูุฉ ุงูุฃููู: ุชุญุฏูุฏ ูุณุงุฑ ุงููุจูู</h3>
                        <p class="text-gray-600 mb-4 md:mb-6 text-sm md:text-base">ุงุฎุชุฑ ููุน ุงููุจูู ุงูููุงุณุจ ูู ูู ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ:</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4">
                            <div class="specialty-card p-4 md:p-5 rounded-lg cursor-pointer text-center" data-type="new">
                                <div class="text-3xl md:text-4xl mb-2 md:mb-3">๐</div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">ุทุงูุจ ุฌุฏูุฏ (ุจูุงููุฑููุณ)</h4>
                                <p class="text-gray-600 text-xs md:text-sm">ูุทูุงุจ ุงูุซุงูููุฉ ุงูุนุงูุฉ ุฃู ุงูููุงุธุฑ ููุง</p>
                                <div class="mt-3 md:mt-4">
                                    <span class="inline-block px-2 md:px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs md:text-sm">ูุณุงุฑ ุฃุณุงุณู</span>
                                </div>
                            </div>
                            
                            <div class="specialty-card p-4 md:p-5 rounded-lg cursor-pointer text-center" data-type="bridging">
                                <div class="text-3xl md:text-4xl mb-2 md:mb-3">๐</div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">ุชุฌุณูุฑ (ุฏุจููู ุฅูู ุจูุงููุฑููุณ)</h4>
                                <p class="text-gray-600 text-xs md:text-sm">ูุญููุฉ ุงูุฏุจููู ุงูุฑุงุบุจูู ูู ุฅููุงู ุงูุจูุงููุฑููุณ</p>
                                <div class="mt-3 md:mt-4">
                                    <span class="inline-block px-2 md:px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs md:text-sm">ูุณุงุฑ ุชููููู</span>
                                </div>
                            </div>
                            
                            <div class="specialty-card p-4 md:p-5 rounded-lg cursor-pointer text-center" data-type="postgraduate">
                                <div class="text-3xl md:text-4xl mb-2 md:mb-3">๐</div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">ุฏุฑุงุณุงุช ุนููุง</h4>
                                <p class="text-gray-600 text-xs md:text-sm">ูุญููุฉ ุงูุจูุงููุฑููุณ ุงูุฑุงุบุจูู ูู ุงููุงุฌุณุชูุฑ ุฃู ุงูุฏูุชูุฑุงู</p>
                                <div class="mt-3 md:mt-4">
                                    <span class="inline-block px-2 md:px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs md:text-sm">ูุณุงุฑ ูุชูุฏู</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bridging Additional Fields (Hidden by Default) -->
                        <div id="bridgingFields" class="mt-4 md:mt-6 p-3 md:p-4 border border-gray-300 rounded-lg hidden">
                            <h4 class="font-bold text-green-800 mb-2 md:mb-3 text-base md:text-lg">ูุนูููุงุช ุฅุถุงููุฉ ููุณุงุฑ ุงูุชุฌุณูุฑ</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุชุฎุตุต ุงูุฏุจููู</label>
                                    <select id="diplomaMajor" class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base">
                                        <option value="">ุงุฎุชุฑ ุชุฎุตุต ุงูุฏุจููู</option>
                                        <option value="it">ุชูููุฉ ุงููุนูููุงุช</option>
                                        <option value="business">ุฅุฏุงุฑุฉ ุงูุฃุนูุงู</option>
                                        <option value="engineering">ููุฏุณุฉ</option>
                                        <option value="health">ุนููู ุตุญูุฉ</option>
                                        <option value="education">ุชุฑุจูุฉ ูุชุนููู</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 text-sm md:text-base">ุงุณู ููู ุดูุงุฏุฉ ุงูุฏุจููู</label>
                                    <input type="text" id="diplomaCertificate" class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุณูุชู ุฑูุนู ูุงุญูุงู">
                                    <p class="text-xs text-gray-500 mt-1">ุณูุชู ุฑูุน ุงูููู ุงูุฃุตูู ูุงุญูุงู ุนุจุฑ ููุตุฉ ุงูุฌุงูุนุฉ</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 md:mt-8 text-left">
                            <button type="button" id="nextToStep2" class="px-6 md:px-8 py-2 md:py-3 bg-green-700 hover:bg-green-800 text-white font-bold rounded-lg transition duration-300 text-sm md:text-base">ุงูุชุงูู โ</button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: ุงูุจูุงูุงุช ุงูุฃูุงุฏูููุฉ -->
                <div id="step2" class="step">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                        <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4 pb-2 border-b border-yellow-200">ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุงูุจูุงูุงุช ุงูุฃูุงุฏูููุฉ</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                            <!-- ุญูู ุงูุฌูุณูุฉ -->
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุงูุฌูุณูุฉ</label>
                                <select id="nationality" name="nationality" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base">
                                    <option value="">ุงุฎุชุฑ ุงูุฌูุณูุฉ</option>
                                    <option value="saudi">ุณุนูุฏู</option>
                                    <option value="non-saudi">ุบูุฑ ุณุนูุฏู</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุงููุนุฏู ุงูุชุฑุงููู (%)</label>
                                <input type="number" id="gpa" name="gpa" min="0" max="100" step="0.1" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุงููุนุฏู ูู 0 ุฅูู 100" inputmode="decimal">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>50% ุงูุญุฏ ุงูุฃุฏูู</span>
                                    <span>100% ุงูุญุฏ ุงูุฃูุตู</span>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุฏุฑุฌุฉ ุงููุฏุฑุงุช ุงูุนุงูุฉ</label>
                                <input type="number" id="aptitude" name="aptitude" min="0" max="100" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุฏุฑุฌุฉ ุงููุฏุฑุงุช" inputmode="decimal">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุฏุฑุฌุฉ ุงูุชุญุตููู</label>
                                <input type="number" id="achievement" name="achievement" min="0" max="100" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุฏุฑุฌุฉ ุงูุชุญุตููู" inputmode="decimal">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 text-sm md:text-base">ุฏุฑุฌุฉ ุงุฎุชุจุงุฑ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ (ุฅู ูุฌุฏุช)</label>
                                <input type="number" id="englishTest" name="englishTest" min="0" max="100" class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุฏุฑุฌุฉ ุงุฎุชุจุงุฑ ุงููุบุฉ" inputmode="decimal">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุณูุฉ ุงูุชุฎุฑุฌ</label>
                                <select id="graduationYear" name="graduationYear" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base">
                                    <option value="">ุงุฎุชุฑ ุณูุฉ ุงูุชุฎุฑุฌ</option>
                                    <option value="2025">2025</option>
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020">2020</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ููุน ุงูุดูุงุฏุฉ ุงูุณุงุจูุฉ</label>
                                <select id="certificateType" name="certificateType" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base">
                                    <option value="">ุงุฎุชุฑ ููุน ุงูุดูุงุฏุฉ</option>
                                    <!-- ุณูุชู ุชุนุจุฆุชูุง ุฏููุงููููุงู -->
                                </select>
                            </div>
                        </div>
                        
                        <!-- ุงููุญุฑู ุงูุฐูู: ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ -->
                        <div id="availableSpecialties" class="mt-6 md:mt-8 p-3 md:p-4 border border-gray-300 rounded-lg hidden">
                            <h4 class="font-bold text-green-800 mb-2 md:mb-3 text-base md:text-lg">ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ ุจูุงุกู ุนูู ุจูุงูุงุชู:</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3" id="specialtiesList">
                                <!-- ุณูุชู ุชุนุจุฆุชูุง ุฏููุงููููุงู -->
                            </div>
                            <p class="text-sm text-gray-600 mt-2 md:mt-3" id="specialtiesNote"></p>
                        </div>
                        
                        <div class="mt-6 md:mt-8 flex justify-between">
                            <button type="button" id="backToStep1" class="px-6 md:px-8 py-2 md:py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-lg transition duration-300 text-sm md:text-base">โ ุงูุณุงุจู</button>
                            <button type="button" id="nextToStep3" class="px-6 md:px-8 py-2 md:py-3 bg-green-700 hover:bg-green-800 text-white font-bold rounded-lg transition duration-300 text-sm md:text-base">ุงูุชุงูู โ</button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: ุงุฎุชูุงุฑ ุงูุชุฎุตุต ูููุน ุงูุฏุฑุงุณุฉ -->
                <div id="step3" class="step">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                        <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4 pb-2 border-b border-yellow-200">ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ุงุฎุชูุงุฑ ุงูุชุฎุตุต ูููุน ุงูุฏุฑุงุณุฉ</h3>
                        
                        <div class="mb-6 md:mb-8">
                            <h4 class="font-bold text-gray-700 mb-2 md:mb-3 required-field text-sm md:text-base">ุงุฎุชุฑ ุงูุชุฎุตุต ุงููุทููุจ</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4" id="specialtiesSelection">
                                <!-- ุณูุชู ุชุนุจุฆุชูุง ุฏููุงููููุงู -->
                            </div>
                        </div>
                        
                        <div class="mb-6 md:mb-8">
                            <h4 class="font-bold text-gray-700 mb-2 md:mb-3 required-field text-sm md:text-base">ููุน ุงูุฏุฑุงุณุฉ</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                                <div class="specialty-card p-4 md:p-5 rounded-lg cursor-pointer text-center" data-study="on-campus">
                                    <div class="text-3xl md:text-4xl mb-2 md:mb-3">๐๏ธ</div>
                                    <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">ุฏุฑุงุณุฉ ุญุถูุฑูุฉ</h4>
                                    <p class="text-gray-600 text-xs md:text-sm">ุงูุญุถูุฑ ุฅูู ุงูุญุฑู ุงูุฌุงูุนู</p>
                                    <div class="mt-3 md:mt-4">
                                        <span class="inline-block px-2 md:px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs md:text-sm">ูุจุงุดุฑุฉ</span>
                                    </div>
                                </div>
                                
                                <div class="specialty-card p-4 md:p-5 rounded-lg cursor-pointer text-center" data-study="distance">
                                    <div class="text-3xl md:text-4xl mb-2 md:mb-3">๐ป</div>
                                    <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">ุฏุฑุงุณุฉ ุนู ุจุนุฏ</h4>
                                    <p class="text-gray-600 text-xs md:text-sm">ุนู ุทุฑูู ุงูููุตุฉ ุงูุชุนููููุฉ</p>
                                    <div class="mt-3 md:mt-4">
                                        <span class="inline-block px-2 md:px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs md:text-sm">ุฃูููุงูู</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6 md:mb-8">
                            <h4 class="font-bold text-gray-700 mb-2 md:mb-3 required-field text-sm md:text-base">ุนุฏุฏ ุงูุณุงุนุงุช ุงููุนุชูุฏุฉ ุงููุชููุน</h4>
                            <div class="flex items-center">
                                <button type="button" id="decreaseHours" class="px-3 md:px-4 py-1 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-l-lg text-sm md:text-base">-</button>
                                <input type="number" id="creditHours" name="creditHours" min="12" max="24" value="15" required class="w-24 md:w-32 p-2 md:p-3 border-t border-b border-gray-300 text-center text-base md:text-lg font-bold" inputmode="numeric">
                                <button type="button" id="increaseHours" class="px-3 md:px-4 py-1 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-r-lg text-sm md:text-base">+</button>
                                <span class="mr-2 md:mr-4 text-gray-700 text-sm md:text-base">ุณุงุนุฉ ูุนุชูุฏุฉ</span>
                            </div>
                            <p class="text-xs md:text-sm text-gray-600 mt-2">ุงูุญุฏ ุงูุฃุฏูู: 12 ุณุงุนุฉ | ุงูุญุฏ ุงูุฃูุตู: 24 ุณุงุนุฉ</p>
                        </div>
                        
                        <div class="mt-6 md:mt-8 flex justify-between">
                            <button type="button" id="backToStep2" class="px-6 md:px-8 py-2 md:py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-lg transition duration-300 text-sm md:text-base">โ ุงูุณุงุจู</button>
                            <button type="button" id="nextToStep4" class="px-6 md:px-8 py-2 md:py-3 bg-green-700 hover:bg-green-800 text-white font-bold rounded-lg transition duration-300 text-sm md:text-base" disabled>ุงูุชุงูู โ</button>
                        </div>
                    </div>
                </div>

                <!-- Step 4: ุงููุนูููุงุช ุงูุดุฎุตูุฉ ูุงููุฑุงุฌุนุฉ -->
                <div id="step4" class="step">
                    <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                        <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4 pb-2 border-b border-yellow-200">ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ: ุงููุนูููุงุช ุงูุดุฎุตูุฉ ูุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ</h3>
                        
                        <div class="mb-6 md:mb-8">
                            <h4 class="font-bold text-gray-700 mb-3 md:mb-4 text-base md:text-lg">ุงููุนูููุงุช ุงูุดุฎุตูุฉ</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุงูุงุณู ุงูุฑุจุงุนู</label>
                                    <input type="text" id="fullName" name="fullName" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุงูุงุณู ุงูุฑุจุงุนู">
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุฑูู ุงููููุฉ ุงููุทููุฉ</label>
                                    <input type="text" id="nationalId" name="nationalId" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="ุฃุฏุฎู ุฑูู ุงููููุฉ (10 ุฃุฑูุงู)" pattern="^[12][0-9]{9}$" title="ูุฌุจ ุฃู ูุจุฏุฃ ุจู 1 ุฃู 2 ููุชููู ูู 10 ุฃุฑูุงู" inputmode="numeric" maxlength="10">
                                    <p class="text-xs text-gray-500 mt-1">ูุจุฏุฃ ุจู 1 ุฃู 2 ู10 ุฃุฑูุงู</p>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                                    <input type="email" id="email" name="email" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="example@domain.com" inputmode="email">
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-1 md:mb-2 required-field text-sm md:text-base">ุฑูู ุงูุฌูุงู</label>
                                    <input type="tel" id="phone" name="phone" required class="w-full p-2 md:p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm md:text-base" placeholder="05XXXXXXXX" pattern="^05\d{8}$" title="ูุจุฏุฃ ุจู 05 ููุชููู ูู 10 ุฃุฑูุงู" inputmode="numeric" maxlength="10">
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6 md:mb-8 p-3 md:p-4 border border-gray-300 rounded-lg bg-gray-50">
                            <h4 class="font-bold text-gray-700 mb-2 md:mb-3 text-base md:text-lg">ููุฎุต ุงูุทูุจ</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                                <div>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ูุณุงุฑ ุงููุจูู:</strong> <span id="reviewPath">-</span></p>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ุงูุชุฎุตุต ุงููุฎุชุงุฑ:</strong> <span id="reviewSpecialty">-</span></p>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ููุน ุงูุฏุฑุงุณุฉ:</strong> <span id="reviewStudyType">-</span></p>
                                </div>
                                <div>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ุงููุนุฏู ุงูุชุฑุงููู:</strong> <span id="reviewGPA">-</span></p>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ุนุฏุฏ ุงูุณุงุนุงุช:</strong> <span id="reviewHours">-</span></p>
                                    <p class="text-gray-600 text-sm md:text-base"><strong>ุงูุฑุณูู ุงููุชููุนุฉ:</strong> <span id="reviewFees">-</span></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6 md:mb-8">
                            <div class="flex items-start">
                                <input type="checkbox" id="agreement" name="agreement" required class="mt-1 ml-2 w-4 h-4 md:w-5 md:h-5">
                                <label for="agreement" class="text-gray-700 text-xs md:text-sm"><span class="text-red-500">*</span> ุฃูุฑ ุจุตุญุฉ ุงูุจูุงูุงุช ุงูููุฏูุฉ ูุฃุชุนูุฏ ุจูุฑุงุกุฉ ุงูุดุฑูุท ูุงูุฃุญูุงู ูุฃูุงูู ุนูู ุงูุงูุชุฒุงู ุจูุง. ููุง ุฃุชููู ุฃู ุชูุฏูู ูุนูููุงุช ุบูุฑ ุตุญูุญุฉ ูุคุฏู ุฅูู ุฅูุบุงุก ุงููุจูู.</label>
                            </div>
                        </div>
                        
                        <div class="mt-6 md:mt-8 flex justify-between">
                            <button type="button" id="backToStep3" class="px-6 md:px-8 py-2 md:py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-lg transition duration-300 text-sm md:text-base">โ ุงูุณุงุจู</button>
                            <button type="button" id="submitApplication" class="px-6 md:px-8 py-2 md:py-3 bg-green-700 hover:bg-green-800 text-white font-bold rounded-lg transition duration-300 text-sm md:text-base disabled:opacity-50 disabled:cursor-not-allowed" disabled>ุฅุฑุณุงู ุงูุทูุจ</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Sidebar: ุญุงุณุจุฉ ุงูุฑุณูู -->
            <div class="lg:w-1/3">
                <div class="fee-sidebar bg-white rounded-xl shadow-lg p-4 md:p-6 sticky top-4 md:top-6">
                    <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4 pb-2 border-b border-yellow-200 text-center">ุญุงุณุจุฉ ุงูุฑุณูู ุงูุชููุงุฆูุฉ</h3>
                    
                    <div class="mb-4 md:mb-6">
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ูุณุงุฑ ุงููุจูู:</span>
                            <span id="feePath" class="font-bold text-sm md:text-base">ูู ูุญุฏุฏ ุจุนุฏ</span>
                        </div>
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ููุน ุงูุฏุฑุงุณุฉ:</span>
                            <span id="feeStudyType" class="font-bold text-sm md:text-base">ูู ูุญุฏุฏ ุจุนุฏ</span>
                        </div>
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ุนุฏุฏ ุงูุณุงุนุงุช:</span>
                            <span id="feeHours" class="font-bold text-sm md:text-base">0</span>
                        </div>
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ุณุนุฑ ุงูุณุงุนุฉ:</span>
                            <span id="feeHourPrice" class="font-bold text-sm md:text-base">0 ุฑูุงู</span>
                        </div>
                    </div>
                    
                    <div class="border-t border-gray-300 pt-3 md:pt-4 mb-3 md:mb-4">
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ุฅุฌูุงูู ุงูุฑุณูู:</span>
                            <span id="feeTotal" class="text-xl md:text-2xl font-bold text-green-700">0 ุฑูุงู</span>
                        </div>
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ุงูุฎุตู:</span>
                            <span id="feeDiscount" class="font-bold text-green-600 text-sm md:text-base">0 ุฑูุงู</span>
                        </div>
                        <div class="flex justify-between items-center mb-1 md:mb-2">
                            <span class="text-gray-700 text-sm md:text-base">ุงูุฑุณูู ุจุนุฏ ุงูุฎุตู:</span>
                            <span id="feeAfterDiscount" class="text-lg md:text-xl font-bold text-green-800">0 ุฑูุงู</span>
                        </div>
                    </div>
                    
                    <div id="feeNote" class="p-2 md:p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-xs md:text-sm text-yellow-800 hidden">
                        <!-- ุณูุชู ุชุนุจุฆุชูุง ุฏููุงููููุงู -->
                    </div>
                    
                    <div class="mt-4 md:mt-6 text-center">
                        <p class="text-gray-600 text-xs md:text-sm">ุณูุชู ุงุญุชุณุงุจ ุงูุฑุณูู ุชููุงุฆูุงู ุจูุงุกู ุนูู ุงุฎุชูุงุฑุงุชู</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-6 md:py-8 mt-6 md:mt-8">
        <div class="container mx-auto px-3 md:px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                <div class="text-center md:text-right">
                    <h3 class="text-lg md:text-xl font-bold mb-3 md:mb-4 text-yellow-100">ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทู</h3>
                    <p class="text-gray-300 text-sm md:text-base">ุจูุงุจุฉ ุงููุจูู ูุงูุชุณุฌูู</p>
                    <p class="text-gray-400 text-xs md:text-sm mt-1 md:mt-2">ูุณุนู ูุชูููู ุงูุทูุจุฉ ูุชุญููู ุฑุคูุฉ ุงูููููุฉ 2030 ูู ุงูุชุนููู</p>
                </div>
                
                <div class="text-center">
                    <h4 class="text-base md:text-lg font-bold mb-3 md:mb-4 text-yellow-100">ูุนูููุงุช ุงูุงุชุตุงู</h4>
                    <div class="space-y-1 md:space-y-2">
                        <p class="text-gray-300 text-sm md:text-base">๐ ุงููุงุชู: <a href="tel:+966133710000" class="hover:text-yellow-300 transition">+966 13 371 0000</a></p>
                        <p class="text-gray-300 text-sm md:text-base">๐ง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: <a href="mailto:admission@uhb.edu.sa" class="hover:text-yellow-300 transition">admission@uhb.edu.sa</a></p>
                        <p class="text-gray-300 text-sm md:text-base">๐ ุงูุนููุงู: ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทูุ ููุทูุฉ ุงูุดุฑููุฉุ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ</p>
                    </div>
                </div>
                
                <div class="text-center md:text-left">
                    <h4 class="text-base md:text-lg font-bold mb-3 md:mb-4 text-yellow-100">ูุณุงุฆู ุงูุชูุงุตู ุงูุงุฌุชูุงุนู</h4>
                    <div class="flex justify-center md:justify-start space-x-3 md:space-x-4 space-x-reverse">
                        <a href="https://twitter.com/UHB_edu_sa" target="_blank" class="social-icon bg-blue-500 text-white hover:bg-blue-600 text-xs md:text-sm">
                            ๐
                        </a>
                        <a href="https://www.instagram.com/uhb_edu_sa" target="_blank" class="social-icon bg-pink-600 text-white hover:bg-pink-700 text-xs md:text-sm">
                            IG
                        </a>
                        <a href="https://www.youtube.com/c/UniversityofHafarAlBatin" target="_blank" class="social-icon bg-red-600 text-white hover:bg-red-700 text-xs md:text-sm">
                            YT
                        </a>
                        <a href="https://www.linkedin.com/school/university-of-hafar-al-batin/" target="_blank" class="social-icon bg-blue-700 text-white hover:bg-blue-800 text-xs md:text-sm">
                            in
                        </a>
                    </div>
                    <p class="text-gray-400 text-xs md:text-sm mt-3 md:mt-4">ุชุงุจุนูุง ููุญุตูู ุนูู ุขุฎุฑ ุงูุฃุฎุจุงุฑ ูุงูุชุญุฏูุซุงุช</p>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-6 md:mt-8 pt-4 md:pt-6 text-center">
                <p class="text-gray-400 text-xs md:text-sm">ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025 ุฌุงูุนุฉ ุญูุฑ ุงูุจุงุทู. ูุฐุง ุงููููุน ูู ุจูุงุจุฉ ุฑุณููุฉ ูููุจูู ูุงูุชุณุฌูู.</p>
                <p class="text-gray-500 text-xs mt-1 md:mt-2">ุงูุฅุตุฏุงุฑ 2.1 | ุขุฎุฑ ุชุญุฏูุซ: ููููู 2025</p>
            </div>
        </div>
    </footer>

    <script>
        // ุจูุงูุงุช ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ
        const specialtiesData = {
            medical: [
                { id: 'medicine', name: 'ุงูุทุจ ุงูุจุดุฑู', minGPA: 95, minAptitude: 90, minAchievement: 90, availableFor: ['new'] },
                { id: 'dentistry', name: 'ุทุจ ุงูุฃุณูุงู', minGPA: 90, minAptitude: 85, minAchievement: 85, availableFor: ['new'] },
                { id: 'pharmacy', name: 'ุงูุตูุฏูุฉ', minGPA: 85, minAptitude: 80, minAchievement: 80, availableFor: ['new', 'bridging'] }
            ],
            engineering: [
                { id: 'civil', name: 'ุงูููุฏุณุฉ ุงููุฏููุฉ', minGPA: 80, minAptitude: 75, minAchievement: 75, availableFor: ['new', 'bridging'] },
                { id: 'computer', name: 'ููุฏุณุฉ ุงูุญุงุณูุจ', minGPA: 80, minAptitude: 75, minAchievement: 75, availableFor: ['new', 'bridging'] },
                { id: 'electrical', name: 'ุงูููุฏุณุฉ ุงูููุฑุจุงุฆูุฉ', minGPA: 80, minAptitude: 75, minAchievement: 75, availableFor: ['new', 'bridging'] }
            ],
            science: [
                { id: 'cs', name: 'ุนููู ุงูุญุงุณูุจ', minGPA: 75, minAptitude: 70, minAchievement: 70, availableFor: ['new', 'bridging', 'postgraduate'] },
                { id: 'math', name: 'ุงูุฑูุงุถูุงุช', minGPA: 75, minAptitude: 70, minAchievement: 70, availableFor: ['new', 'bridging'] },
                { id: 'physics', name: 'ุงูููุฒูุงุก', minGPA: 75, minAptitude: 70, minAchievement: 70, availableFor: ['new', 'bridging'] }
            ],
            business: [
                { id: 'management', name: 'ุฅุฏุงุฑุฉ ุงูุฃุนูุงู', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging', 'postgraduate'] },
                { id: 'accounting', name: 'ุงููุญุงุณุจุฉ', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging'] },
                { id: 'marketing', name: 'ุงูุชุณููู', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging'] }
            ],
            humanities: [
                { id: 'arabic', name: 'ุงููุบุฉ ุงูุนุฑุจูุฉ', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging', 'postgraduate'] },
                { id: 'english', name: 'ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging'] },
                { id: 'history', name: 'ุงูุชุงุฑูุฎ', minGPA: 70, minAptitude: 65, minAchievement: 65, availableFor: ['new', 'bridging'] }
            ]
        };

        // ุญุงูุฉ ุงูุชุทุจูู
        const appState = {
            currentStep: 1,
            admissionPath: null,
            selectedSpecialty: null,
            studyType: null,
            creditHours: 15,
            gpa: null,
            aptitude: null,
            achievement: null,
            englishTest: null,
            nationality: null,
            agreementChecked: false,
            calculatedFees: 0
        };

        // ุชููุฆุฉ ุงูุชุทุจูู
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            updateProgressBar();
            updateCertificateTypeOptions();
            setupNumericInputValidation();
            
            // ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ูู sessionStorage ุฅุฐุง ูุฌุฏุช
            restoreFromSessionStorage();
        });

        // ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ูู sessionStorage
        function restoreFromSessionStorage() {
            try {
                const savedData = sessionStorage.getItem('admissionFormData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    // ุงุณุชุนุงุฏุฉ ุจูุงูุงุช ุงููุณุงุฑ
                    if (data.admissionPath) {
                        appState.admissionPath = data.admissionPath;
                        const pathCard = document.querySelector(`.specialty-card[data-type="${data.admissionPath}"]`);
                        if (pathCard) {
                            document.querySelectorAll('.specialty-card[data-type]').forEach(c => c.classList.remove('selected'));
                            pathCard.classList.add('selected');
                            
                            if (data.admissionPath === 'bridging') {
                                document.getElementById('bridgingFields').classList.remove('hidden');
                                if (data.diplomaMajor) {
                                    document.getElementById('diplomaMajor').value = data.diplomaMajor;
                                }
                                if (data.diplomaCertificate) {
                                    document.getElementById('diplomaCertificate').value = data.diplomaCertificate;
                                }
                            }
                        }
                    }
                    
                    // ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุงูุฃูุงุฏูููุฉ
                    if (data.gpa) {
                        document.getElementById('gpa').value = data.gpa;
                        appState.gpa = data.gpa;
                    }
                    if (data.aptitude) {
                        document.getElementById('aptitude').value = data.aptitude;
                        appState.aptitude = data.aptitude;
                    }
                    if (data.achievement) {
                        document.getElementById('achievement').value = data.achievement;
                        appState.achievement = data.achievement;
                    }
                    if (data.englishTest) {
                        document.getElementById('englishTest').value = data.englishTest;
                        appState.englishTest = data.englishTest;
                    }
                    if (data.nationality) {
                        document.getElementById('nationality').value = data.nationality;
                        appState.nationality = data.nationality;
                    }
                    if (data.graduationYear) {
                        document.getElementById('graduationYear').value = data.graduationYear;
                    }
                    if (data.certificateType) {
                        document.getElementById('certificateType').value = data.certificateType;
                    }
                    
                    // ุงุณุชุนุงุฏุฉ ุงูุชุฎุตุต ุงููุฎุชุงุฑ
                    if (data.selectedSpecialty) {
                        appState.selectedSpecialty = data.selectedSpecialty;
                    }
                    
                    // ุงุณุชุนุงุฏุฉ ููุน ุงูุฏุฑุงุณุฉ
                    if (data.studyType) {
                        appState.studyType = data.studyType;
                        const studyCard = document.querySelector(`.specialty-card[data-study="${data.studyType}"]`);
                        if (studyCard) {
                            document.querySelectorAll('.specialty-card[data-study]').forEach(c => c.classList.remove('selected'));
                            studyCard.classList.add('selected');
                        }
                    }
                    
                    // ุงุณุชุนุงุฏุฉ ุนุฏุฏ ุงูุณุงุนุงุช
                    if (data.creditHours) {
                        appState.creditHours = data.creditHours;
                        document.getElementById('creditHours').value = data.creditHours;
                    }
                    
                    // ุชุญุฏูุซ ุงููุงุฌูุฉ
                    updateCertificateTypeOptions();
                    updateAvailableSpecialties();
                    updateFeeCalculator();
                }
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช:', error);
            }
        }

        // ุญูุธ ุงูุจูุงูุงุช ูู sessionStorage
        function saveToSessionStorage() {
            try {
                const formData = {
                    admissionPath: appState.admissionPath,
                    gpa: appState.gpa,
                    aptitude: appState.aptitude,
                    achievement: appState.achievement,
                    englishTest: appState.englishTest,
                    nationality: appState.nationality,
                    selectedSpecialty: appState.selectedSpecialty,
                    studyType: appState.studyType,
                    creditHours: appState.creditHours,
                    diplomaMajor: document.getElementById('diplomaMajor').value,
                    diplomaCertificate: document.getElementById('diplomaCertificate').value,
                    graduationYear: document.getElementById('graduationYear').value,
                    certificateType: document.getElementById('certificateType').value
                };
                
                sessionStorage.setItem('admissionFormData', JSON.stringify(formData));
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุญูุธ ุงูุจูุงูุงุช:', error);
            }
        }

        // ุฅุนุฏุงุฏ ุงูุชุญูู ูู ุงููุฏุฎูุงุช ุงูุฑูููุฉ ูููุน ุงูุญุฑูู
        function setupNumericInputValidation() {
            const numericFields = ['nationalId', 'phone', 'gpa', 'aptitude', 'achievement', 'creditHours', 'englishTest'];
            
            numericFields.forEach(id => {
                const field = document.getElementById(id);
                if (field) {
                    field.addEventListener('keypress', (e) => {
                        const allowedKeys = /[0-9\.]/;
                        const isAllowed = allowedKeys.test(e.key) || 
                                         e.key === 'Backspace' || 
                                         e.key === 'Delete' || 
                                         e.key === 'Tab' || 
                                         e.key === 'ArrowLeft' || 
                                         e.key === 'ArrowRight';
                        
                        if (!isAllowed) {
                            e.preventDefault();
                            return;
                        }
                        
                        if (e.key === '.') {
                            if (field.value.includes('.')) {
                                e.preventDefault();
                            }
                        }
                    });
                    
                    field.addEventListener('paste', (e) => {
                        const pastedData = e.clipboardData.getData('text');
                        const numericOnly = pastedData.replace(/[^0-9\.]/g, '');
                        
                        const parts = numericOnly.split('.');
                        let cleaned = parts[0];
                        if (parts.length > 1) {
                            cleaned += '.' + parts[1];
                        }
                        
                        e.preventDefault();
                        
                        const start = field.selectionStart;
                        const end = field.selectionEnd;
                        const currentValue = field.value;
                        
                        field.value = currentValue.substring(0, start) + cleaned + currentValue.substring(end);
                        field.setSelectionRange(start + cleaned.length, start + cleaned.length);
                        
                        field.dispatchEvent(new Event('input'));
                    });
                    
                    if (id === 'gpa' || id === 'aptitude' || id === 'achievement' || id === 'englishTest') {
                        field.setAttribute('inputmode', 'decimal');
                    } else {
                        field.setAttribute('inputmode', 'numeric');
                    }
                }
            });
        }

        // ุชุนุฑูู ุฌููุน ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ
        function initializeEventListeners() {
            // ุงุฎุชูุงุฑ ูุณุงุฑ ุงููุจูู
            document.querySelectorAll('.specialty-card[data-type]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.specialty-card[data-type]').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const oldPath = appState.admissionPath;
                    appState.admissionPath = this.getAttribute('data-type');
                    
                    if (oldPath !== appState.admissionPath) {
                        resetStepData();
                    }
                    
                    updateCertificateTypeOptions();
                    
                    const bridgingFields = document.getElementById('bridgingFields');
                    if (appState.admissionPath === 'bridging') {
                        bridgingFields.classList.remove('hidden');
                    } else {
                        bridgingFields.classList.add('hidden');
                        document.getElementById('diplomaMajor').value = '';
                        document.getElementById('diplomaCertificate').value = '';
                    }
                    
                    updateFeeCalculator();
                    saveToSessionStorage();
                });
            });

            // ุงุฎุชูุงุฑ ููุน ุงูุฏุฑุงุณุฉ
            document.querySelectorAll('.specialty-card[data-study]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.specialty-card[data-study]').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    appState.studyType = this.getAttribute('data-study');
                    updateFeeCalculator();
                    validateStep3();
                    saveToSessionStorage();
                });
            });

            // ุฃุฒุฑุงุฑ ุงูุชููู ุจูู ุงูุฎุทูุงุช
            document.getElementById('nextToStep2').addEventListener('click', () => navigateToStep(2));
            document.getElementById('nextToStep3').addEventListener('click', () => navigateToStep(3));
            document.getElementById('nextToStep4').addEventListener('click', () => navigateToStep(4));
            document.getElementById('backToStep1').addEventListener('click', () => navigateToStep(1));
            document.getElementById('backToStep2').addEventListener('click', () => navigateToStep(2));
            document.getElementById('backToStep3').addEventListener('click', () => navigateToStep(3));

            // ุฒูุงุฏุฉ/ููุตุงู ุนุฏุฏ ุงูุณุงุนุงุช
            document.getElementById('increaseHours').addEventListener('click', () => {
                const hoursInput = document.getElementById('creditHours');
                let currentHours = parseInt(hoursInput.value);
                if (currentHours < 24) {
                    hoursInput.value = currentHours + 1;
                    appState.creditHours = hoursInput.value;
                    updateFeeCalculator();
                    saveToSessionStorage();
                }
            });

            document.getElementById('decreaseHours').addEventListener('click', () => {
                const hoursInput = document.getElementById('creditHours');
                let currentHours = parseInt(hoursInput.value);
                if (currentHours > 12) {
                    hoursInput.value = currentHours - 1;
                    appState.creditHours = hoursInput.value;
                    updateFeeCalculator();
                    saveToSessionStorage();
                }
            });

            document.getElementById('creditHours').addEventListener('input', function() {
                let hours = parseInt(this.value);
                if (isNaN(hours)) hours = 12;
                if (hours < 12) hours = 12;
                if (hours > 24) hours = 24;
                this.value = hours;
                appState.creditHours = hours;
                updateFeeCalculator();
                saveToSessionStorage();
            });

            document.getElementById('creditHours').addEventListener('change', function() {
                let hours = parseInt(this.value);
                if (hours < 12) hours = 12;
                if (hours > 24) hours = 24;
                this.value = hours;
                appState.creditHours = hours;
                updateFeeCalculator();
                saveToSessionStorage();
            });

            // ุชุญุฏูุซ ุงููุญุฑู ุงูุฐูู ุนูุฏ ุชุบููุฑ ุงูุฏุฑุฌุงุช
            document.getElementById('gpa').addEventListener('input', function() {
                const gpaValue = parseFloat(this.value) || 0;
                appState.gpa = gpaValue;
                appState.selectedSpecialty = null;
                updateAvailableSpecialties();
                validateStep3();
                saveToSessionStorage();
            });
            
            document.getElementById('aptitude').addEventListener('input', function() {
                const aptitudeValue = parseFloat(this.value) || 0;
                appState.aptitude = aptitudeValue;
                appState.selectedSpecialty = null;
                updateAvailableSpecialties();
                validateStep3();
                saveToSessionStorage();
            });
            
            document.getElementById('achievement').addEventListener('input', function() {
                const achievementValue = parseFloat(this.value) || 0;
                appState.achievement = achievementValue;
                appState.selectedSpecialty = null;
                updateAvailableSpecialties();
                validateStep3();
                saveToSessionStorage();
            });
            
            document.getElementById('englishTest').addEventListener('input', function() {
                appState.englishTest = this.value || null;
                saveToSessionStorage();
            });

            // ุชุญุฏูุซ ุงูุฌูุณูุฉ
            document.getElementById('nationality').addEventListener('change', function() {
                appState.nationality = this.value;
                updateFeeCalculator();
                updateReviewSection();
                saveToSessionStorage();
            });

            // ุชุญุฏูุซ ุงุชูุงููุฉ ุงูุดุฑูุท
            document.getElementById('agreement').addEventListener('change', function() {
                appState.agreementChecked = this.checked;
                document.getElementById('submitApplication').disabled = !this.checked;
            });

            // ุฅุฑุณุงู ุงูุทูุจ
            document.getElementById('submitApplication').addEventListener('click', submitApplication);

            // ุชุญุฏูุซ ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ ุนูุฏ ุชุบููุฑ ุงูุจูุงูุงุช
            document.getElementById('fullName').addEventListener('input', updateReviewSection);
            document.getElementById('nationalId').addEventListener('input', updateReviewSection);
            document.getElementById('email').addEventListener('input', updateReviewSection);
            document.getElementById('phone').addEventListener('input', updateReviewSection);
            
            // ุงูุญููู ุงูุฅุถุงููุฉ ููุณุงุฑ ุงูุชุฌุณูุฑ
            document.getElementById('diplomaMajor').addEventListener('change', saveToSessionStorage);
            document.getElementById('diplomaCertificate').addEventListener('input', saveToSessionStorage);
            document.getElementById('graduationYear').addEventListener('change', saveToSessionStorage);
            document.getElementById('certificateType').addEventListener('change', saveToSessionStorage);
            
            // Event Delegation ููุนูุงุตุฑ ุงูุฏููุงููููุฉ ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ
            document.addEventListener('click', function(e) {
                if (e.target.closest('.specialty-card-step2')) {
                    const card = e.target.closest('.specialty-card-step2');
                    if (card && !card.classList.contains('selected')) {
                        appState.selectedSpecialty = {
                            id: card.dataset.id,
                            name: card.dataset.name,
                            minGPA: card.dataset.gpa,
                            minAptitude: card.dataset.aptitude,
                            minAchievement: card.dataset.achievement
                        };
                        
                        validateStep3();
                    }
                }
                
                if (e.target.closest('.specialty-card[data-id]')) {
                    setTimeout(() => {
                        validateStep3();
                    }, 100);
                }
            });
            
            // ุฅุถุงูุฉ event listener ุฎุงุต ููููุงุชู ุงููุญูููุฉ
            document.addEventListener('touchstart', function(e) {
                if (e.target.closest('.specialty-card-step2') || e.target.closest('.specialty-card[data-id]')) {
                    e.preventDefault();
                    e.target.click();
                }
            }, { passive: false });
            
            // ุญูุธ ุงูุจูุงูุงุช ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ
            window.addEventListener('beforeunload', saveToSessionStorage);
        }

        // ุชุญุฏูุซ ุฎูุงุฑุงุช ููุน ุงูุดูุงุฏุฉ ุจูุงุกู ุนูู ุงููุณุงุฑ
        function updateCertificateTypeOptions() {
            const certificateTypeSelect = document.getElementById('certificateType');
            const currentValue = certificateTypeSelect.value;
            
            certificateTypeSelect.innerHTML = '<option value="">ุงุฎุชุฑ ููุน ุงูุดูุงุฏุฉ</option>';
            
            if (appState.admissionPath === 'new') {
                certificateTypeSelect.innerHTML += `<option value="highSchool">ุซุงูููุฉ ุนุงูุฉ</option>`;
            } else if (appState.admissionPath === 'bridging') {
                certificateTypeSelect.innerHTML += `<option value="diploma">ุฏุจููู</option>`;
            } else if (appState.admissionPath === 'postgraduate') {
                certificateTypeSelect.innerHTML += `<option value="bachelor">ุจูุงููุฑููุณ</option>`;
            }
            
            if (currentValue) {
                const optionExists = Array.from(certificateTypeSelect.options).some(option => option.value === currentValue);
                if (optionExists) {
                    certificateTypeSelect.value = currentValue;
                }
            }
        }

        // ุชุทููุฑ ุงูุจูุงูุงุช ุนูุฏ ุชุบููุฑ ุงููุณุงุฑ
        function resetStepData() {
            appState.selectedSpecialty = null;
            appState.studyType = null;
            appState.gpa = null;
            appState.aptitude = null;
            appState.achievement = null;
            appState.englishTest = null;
            appState.nationality = null;
            appState.agreementChecked = false;
            
            document.getElementById('gpa').value = '';
            document.getElementById('aptitude').value = '';
            document.getElementById('achievement').value = '';
            document.getElementById('englishTest').value = '';
            document.getElementById('graduationYear').value = '';
            document.getElementById('certificateType').value = '';
            document.getElementById('nationality').value = '';
            document.getElementById('fullName').value = '';
            document.getElementById('nationalId').value = '';
            document.getElementById('email').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('agreement').checked = false;
            
            document.querySelectorAll('.specialty-card[data-id]').forEach(c => c.classList.remove('selected'));
            document.querySelectorAll('.specialty-card[data-study]').forEach(c => c.classList.remove('selected'));
            
            document.getElementById('nextToStep4').disabled = true;
            document.getElementById('submitApplication').disabled = true;
            
            saveToSessionStorage();
        }

        // ุงูุชููู ุจูู ุงูุฎุทูุงุช
        function navigateToStep(step) {
            if (step > appState.currentStep) {
                if (!validateCurrentStep()) {
                    return;
                }
            }

            appState.currentStep = step;
            
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            
            updateProgressBar();
            updateProgressNumbers(step);
            
            if (step === 2) {
                updateAvailableSpecialties();
            }
            
            if (step === 3) {
                populateSpecialtiesSelection();
                validateStep3();
            }
            
            if (step === 4) {
                updateReviewSection();
            }
            
            updateFeeCalculator();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ุชุญุฏูุซ ุดุฑูุท ุงูุชูุฏู
        function updateProgressBar() {
            const progressPercentage = (appState.currentStep / 4) * 100;
            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
        }

        // ุชุญุฏูุซ ุฃุฑูุงู ุงูุฎุทูุงุช
        function updateProgressNumbers(currentStep) {
            const steps = document.querySelectorAll('.text-center.w-1\/4 .w-8, .text-center.w-1\/4 .w-10');
            steps.forEach((step, index) => {
                const stepNumber = index + 1;
                if (stepNumber < currentStep) {
                    step.classList.remove('bg-gray-300', 'text-gray-700');
                    step.classList.add('bg-green-700', 'text-white');
                } else if (stepNumber === currentStep) {
                    step.classList.remove('bg-gray-300', 'text-gray-700');
                    step.classList.add('bg-green-700', 'text-white');
                } else {
                    step.classList.remove('bg-green-700', 'text-white');
                    step.classList.add('bg-gray-300', 'text-gray-700');
                }
            });
        }

        // ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูู ุงูุฎุทูุฉ ุงูุญุงููุฉ
        function validateCurrentStep() {
            const currentStep = appState.currentStep;
            
            if (currentStep === 1) {
                if (!appState.admissionPath) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ูุณุงุฑ ุบูุฑ ูุญุฏุฏ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ูุณุงุฑ ุงููุจูู ุงูููุงุณุจ ูู',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (appState.admissionPath === 'bridging') {
                    const diplomaMajor = document.getElementById('diplomaMajor').value;
                    
                    if (!diplomaMajor) {
                        Swal.fire({
                            icon: 'warning',
                            title: 'ุจูุงูุงุช ูุงูุตุฉ',
                            text: 'ูุฑุฌู ุงุฎุชูุงุฑ ุชุฎุตุต ุงูุฏุจููู',
                            confirmButtonText: 'ุญุณููุง',
                            confirmButtonColor: '#006837'
                        });
                        return false;
                    }
                }
            }
            
            if (currentStep === 2) {
                const gpa = parseFloat(document.getElementById('gpa').value) || 0;
                const aptitude = parseFloat(document.getElementById('aptitude').value) || 0;
                const achievement = parseFloat(document.getElementById('achievement').value) || 0;
                const graduationYear = document.getElementById('graduationYear').value;
                const certificateType = document.getElementById('certificateType').value;
                const nationality = document.getElementById('nationality').value;
                
                if (!gpa || gpa < 50 || gpa > 100) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ูุนุฏู ุชุฑุงููู ุบูุฑ ุตุงูุญ',
                        text: 'ูุฑุฌู ุฅุฏุฎุงู ูุนุฏู ุชุฑุงููู ุตุญูุญ ุจูู 50 ู 100',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!aptitude || aptitude < 0 || aptitude > 100) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุฏุฑุฌุฉ ูุฏุฑุงุช ุบูุฑ ุตุงูุญุฉ',
                        text: 'ูุฑุฌู ุฅุฏุฎุงู ุฏุฑุฌุฉ ูุฏุฑุงุช ุตุญูุญุฉ ุจูู 0 ู 100',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!achievement || achievement < 0 || achievement > 100) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุฏุฑุฌุฉ ุชุญุตููู ุบูุฑ ุตุงูุญุฉ',
                        text: 'ูุฑุฌู ุฅุฏุฎุงู ุฏุฑุฌุฉ ุชุญุตููู ุตุญูุญุฉ ุจูู 0 ู 100',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!graduationYear) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุณูุฉ ุงูุชุบูุฑ ุบูุฑ ูุญุฏุฏุฉ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ุณูุฉ ุงูุชุฎุฑุฌ',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!certificateType) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ููุน ุงูุดูุงุฏุฉ ุบูุฑ ูุญุฏุฏ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุดูุงุฏุฉ ุงูุณุงุจูุฉ',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!nationality) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุงูุฌูุณูุฉ ุบูุฑ ูุญุฏุฏุฉ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฌูุณูุฉ',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                appState.gpa = gpa;
                appState.aptitude = aptitude;
                appState.achievement = achievement;
                appState.englishTest = document.getElementById('englishTest').value || null;
                appState.nationality = nationality;
                
                const availableSpecialties = getAvailableSpecialties();
                if (availableSpecialties.length === 0) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ูุง ุชูุฌุฏ ุชุฎุตุตุงุช ูุชุงุญุฉ',
                        text: 'ุจูุงุกู ุนูู ุจูุงูุงุชู ุงูุฃูุงุฏูููุฉุ ูุง ุชูุฌุฏ ุชุฎุตุตุงุช ูุชุงุญุฉ ูู. ูุฑุฌู ุชุนุฏูู ุจูุงูุงุชู ุฃู ุงุฎุชูุงุฑ ูุณุงุฑ ูุจูู ุขุฎุฑ.',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                const creditHours = parseInt(document.getElementById('creditHours').value);
                if (creditHours < 12 || creditHours > 24 || isNaN(creditHours)) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุนุฏุฏ ุณุงุนุงุช ุบูุฑ ุตุงูุญ',
                        text: 'ูุฑุฌู ุฅุฏุฎุงู ุนุฏุฏ ุณุงุนุงุช ูุนุชูุฏุฉ ุจูู 12 ู 24',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
            }
            
            if (currentStep === 3) {
                if (!appState.selectedSpecialty) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ุชุฎุตุต ุบูุฑ ูุญุฏุฏ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ุงูุชุฎุตุต ุงูููุงุณุจ ูู',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
                
                if (!appState.studyType) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ููุน ุงูุฏุฑุงุณุฉ ุบูุฑ ูุญุฏุฏ',
                        text: 'ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุฏุฑุงุณุฉ (ุญุถูุฑู/ุนู ุจุนุฏ)',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837'
                    });
                    return false;
                }
            }
            
            return true;
        }

        // ุงูุญุตูู ุนูู ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงูุญุงููุฉ
        function getAvailableSpecialties() {
            const gpa = parseFloat(document.getElementById('gpa').value) || 0;
            const aptitude = parseFloat(document.getElementById('aptitude').value) || 0;
            const achievement = parseFloat(document.getElementById('achievement').value) || 0;
            
            let allSpecialties = [];
            for (const category in specialtiesData) {
                allSpecialties = allSpecialties.concat(specialtiesData[category]);
            }
            
            return allSpecialties.filter(specialty => {
                if (!specialty.availableFor.includes(appState.admissionPath)) {
                    return false;
                }
                
                if (gpa >= specialty.minGPA && aptitude >= specialty.minAptitude && achievement >= specialty.minAchievement) {
                    return true;
                }
                
                return false;
            });
        }

        // ุชุญุฏูุซ ุงููุญุฑู ุงูุฐูู: ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ - ูุน ุชูุนูู ุงุฎุชูุงุฑ ุงูุชุฎุตุต ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ
        function updateAvailableSpecialties() {
            const gpa = parseFloat(document.getElementById('gpa').value);
            const aptitude = parseFloat(document.getElementById('aptitude').value);
            const achievement = parseFloat(document.getElementById('achievement').value);
            
            if (!gpa || !aptitude || !achievement) {
                document.getElementById('availableSpecialties').classList.add('hidden');
                return;
            }
            
            const specialtiesList = document.getElementById('specialtiesList');
            specialtiesList.innerHTML = '';
            
            const availableSpecialties = getAvailableSpecialties();
            
            const availableSpecialtiesDiv = document.getElementById('availableSpecialties');
            if (availableSpecialties.length > 0) {
                availableSpecialtiesDiv.classList.remove('hidden');
                
                availableSpecialties.forEach(specialty => {
                    const specialtyCard = document.createElement('div');
                    specialtyCard.className = 'specialty-card-step2 p-3 md:p-4 border border-gray-300 rounded-lg bg-green-50';
                    specialtyCard.dataset.id = specialty.id;
                    specialtyCard.dataset.name = specialty.name;
                    specialtyCard.dataset.gpa = specialty.minGPA;
                    specialtyCard.dataset.aptitude = specialty.minAptitude;
                    specialtyCard.dataset.achievement = specialty.minAchievement;
                    
                    if (appState.selectedSpecialty && appState.selectedSpecialty.id === specialty.id) {
                        specialtyCard.classList.add('selected');
                        specialtyCard.classList.remove('bg-green-50');
                        specialtyCard.classList.add('bg-green-100');
                    }
                    
                    specialtyCard.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h5 class="font-bold text-green-800 text-sm md:text-base">${specialty.name}</h5>
                                <p class="text-xs md:text-sm text-gray-600 mt-1">ุงูุญุฏ ุงูุฃุฏูู: ${specialty.minGPA}% ูุนุฏูุ ${specialty.minAptitude}% ูุฏุฑุงุชุ ${specialty.minAchievement}% ุชุญุตููู</p>
                            </div>
                            <div class="text-green-700">
                                ${appState.selectedSpecialty && appState.selectedSpecialty.id === specialty.id ? 
                                    '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>' : 
                                    '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>'
                                }
                            </div>
                        </div>
                    `;
                    
                    // ุฅุถุงูุฉ Event Listener ูุจุงุดุฑุฉ ููู ุจุทุงูุฉ ุชุฎุตุต ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ
                    specialtyCard.addEventListener('click', function() {
                        // 1. ุฅุฒุงูุฉ ุงูุชุญุฏูุฏ ูู ุฌููุน ุงูุจุทุงูุงุช ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ
                        document.querySelectorAll('.specialty-card-step2').forEach(card => {
                            card.classList.remove('selected');
                            card.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                            card.classList.remove('bg-green-100');
                            card.classList.add('bg-green-50');
                        });
                        
                        // 2. ุฅุถุงูุฉ ุงูุชุญุฏูุฏ ููุจุทุงูุฉ ุงููุฎุชุงุฑุฉ
                        this.classList.add('selected');
                        this.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                        this.classList.remove('bg-green-50');
                        this.classList.add('bg-green-100');
                        
                        // 3. ุฅุณูุงุฏ ูููุฉ ุงูุชุฎุตุต ุงููุฎุชุงุฑ ุฅูู appState
                        appState.selectedSpecialty = {
                            id: this.dataset.id,
                            name: this.dataset.name,
                            minGPA: this.dataset.gpa,
                            minAptitude: this.dataset.aptitude,
                            minAchievement: this.dataset.achievement
                        };
                        
                        // 4. ุชุญุฏูุซ ุญุงุณุจุฉ ุงูุฑุณูู
                        updateFeeCalculator();
                        
                        // 5. ุชุญุฏูุซ ูุณู ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ
                        updateReviewSection();
                        
                        // 6. ุญูุธ ูู sessionStorage
                        saveToSessionStorage();
                        
                        // 7. ุงูุงูุชูุงู ุงูุชููุงุฆู ูููุฑุญูุฉ ุงูุซุงูุซุฉ ุจุนุฏ ุชุฃุฎูุฑ ุจุณูุท
                        setTimeout(() => {
                            navigateToStep(3);
                        }, 500);
                    });
                    
                    specialtiesList.appendChild(specialtyCard);
                });
                
                document.getElementById('specialtiesNote').textContent = `ููุงู ${availableSpecialties.length} ุชุฎุตุต(ุงุช) ูุชุงุญ(ุฉ) ูู ุจูุงุกู ุนูู ุจูุงูุงุชู. ุงููุฑ ุนูู ุฃู ุชุฎุตุต ููุงูุชูุงู ุงูุชููุงุฆู ูููุฑุญูุฉ ุงูุชุงููุฉ.`;
                document.getElementById('specialtiesNote').className = 'text-sm text-green-600 mt-2 md:mt-3';
                
                // ุฅุถุงูุฉ Event Delegation ููุนูุตุฑ ุงูุฃุณุงุณู (ูุณุฎุฉ ุงุญุชูุงุทูุฉ)
                specialtiesList.addEventListener('click', function(e) {
                    const card = e.target.closest('.specialty-card-step2');
                    if (card && !card.classList.contains('selected')) {
                        // ุฅุนุงุฏุฉ ุชุดุบูู ููุณ ููุทู ุงูููุฑ
                        document.querySelectorAll('.specialty-card-step2').forEach(c => {
                            c.classList.remove('selected');
                            c.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                            c.classList.remove('bg-green-100');
                            c.classList.add('bg-green-50');
                        });
                        
                        card.classList.add('selected');
                        card.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                        card.classList.remove('bg-green-50');
                        card.classList.add('bg-green-100');
                        
                        appState.selectedSpecialty = {
                            id: card.dataset.id,
                            name: card.dataset.name,
                            minGPA: card.dataset.gpa,
                            minAptitude: card.dataset.aptitude,
                            minAchievement: card.dataset.achievement
                        };
                        
                        updateFeeCalculator();
                        updateReviewSection();
                        saveToSessionStorage();
                        
                        setTimeout(() => {
                            navigateToStep(3);
                        }, 500);
                    }
                });
            } else {
                availableSpecialtiesDiv.classList.remove('hidden');
                document.getElementById('specialtiesNote').textContent = 'ูุง ุชูุฌุฏ ุชุฎุตุตุงุช ูุชุงุญุฉ ูู ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ. ุญุงูู ุชุญุณูู ุฏุฑุฌุงุชู ุฃู ุงุฎุชูุงุฑ ูุณุงุฑ ุขุฎุฑ.';
                document.getElementById('specialtiesNote').className = 'text-sm text-red-600 mt-2 md:mt-3';
            }
        }

        // ุชุนุจุฆุฉ ุงุฎุชูุงุฑุงุช ุงูุชุฎุตุต ูู ุงูุฎุทูุฉ 3 - ูุน ูุฒุงููุฉ ุงูุจูุงูุงุช ุจูู ุงููุฑุญูุชูู
        function populateSpecialtiesSelection() {
            const specialtiesSelection = document.getElementById('specialtiesSelection');
            specialtiesSelection.innerHTML = '';
            
            const availableSpecialties = getAvailableSpecialties();
            
            if (availableSpecialties.length === 0) {
                specialtiesSelection.innerHTML = '<div class="col-span-2 p-3 md:p-4 text-center bg-red-50 border border-red-200 rounded-lg"><p class="text-red-600 text-sm md:text-base">ูุง ุชูุฌุฏ ุชุฎุตุตุงุช ูุชุงุญุฉ ุจูุงุกู ุนูู ุจูุงูุงุชู. ูุฑุฌู ุงูุนูุฏุฉ ุฅูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ ูุชุนุฏูู ุจูุงูุงุชู.</p></div>';
                appState.selectedSpecialty = null;
                return;
            }
            
            availableSpecialties.forEach(specialty => {
                const specialtyCard = document.createElement('div');
                specialtyCard.className = 'specialty-card p-3 md:p-4 rounded-lg cursor-pointer';
                specialtyCard.dataset.id = specialty.id;
                
                // ูุฑุงุกุฉ ุงููููุฉ ุงููุณุจูุฉ ูู appState ููุถุน ุนูุงูุฉ "ูุฎุชุงุฑ"
                const isSelected = appState.selectedSpecialty && appState.selectedSpecialty.id === specialty.id;
                
                if (isSelected) {
                    specialtyCard.classList.add('selected');
                }
                
                specialtyCard.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h5 class="font-bold text-gray-800 text-sm md:text-base">${specialty.name}</h5>
                            <p class="text-xs md:text-sm text-gray-600 mt-1">ุงูุญุฏ ุงูุฃุฏูู: ${specialty.minGPA}% ูุนุฏูุ ${specialty.minAptitude}% ูุฏุฑุงุชุ ${specialty.minAchievement}% ุชุญุตููู</p>
                        </div>
                        <div class="text-green-700">
                            ${isSelected ? 
                                '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>' : 
                                '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>'
                            }
                        </div>
                    </div>
                `;
                
                // Event Listener ููู ุจุทุงูุฉ ุชุฎุตุต ูู ุงููุฑุญูุฉ ุงูุซุงูุซุฉ
                specialtyCard.addEventListener('click', function() {
                    document.querySelectorAll('.specialty-card[data-id]').forEach(c => {
                        c.classList.remove('selected');
                        c.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                    });
                    
                    this.classList.add('selected');
                    this.querySelector('svg').outerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                    
                    appState.selectedSpecialty = specialty;
                    updateFeeCalculator();
                    
                    // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุงูุชุญูู ููุฑ ุงูููุฑ
                    validateStep3();
                    
                    // ุญูุธ ูู sessionStorage
                    saveToSessionStorage();
                });
                
                specialtiesSelection.appendChild(specialtyCard);
            });
            
            // ุฅุฐุง ูุงู ููุงู ุชุฎุตุต ูุญุฏุฏ ูุณุจูุงู ูู appStateุ ุชุฃูุฏ ูู ุชุญุฏูุซ ุฒุฑ "ุงูุชุงูู"
            if (appState.selectedSpecialty) {
                validateStep3();
            }
        }

        // ุงูุชุญูู ูู ุตุญุฉ ุงูุฎุทูุฉ 3
        function validateStep3() {
            const nextButton = document.getElementById('nextToStep4');
            const isSpecialtySelected = appState.selectedSpecialty !== null;
            const isStudyTypeSelected = appState.studyType !== null;
            
            if (isSpecialtySelected && isStudyTypeSelected) {
                nextButton.disabled = false;
                nextButton.classList.remove('opacity-50', 'cursor-not-allowed');
                nextButton.classList.add('hover:bg-green-800');
            } else {
                nextButton.disabled = true;
                nextButton.classList.add('opacity-50', 'cursor-not-allowed');
                nextButton.classList.remove('hover:bg-green-800');
            }
        }

        // ุชุญุฏูุซ ุญุงุณุจุฉ ุงูุฑุณูู
        function updateFeeCalculator() {
            const feePath = document.getElementById('feePath');
            const feeStudyType = document.getElementById('feeStudyType');
            const feeHours = document.getElementById('feeHours');
            const feeHourPrice = document.getElementById('feeHourPrice');
            const feeTotal = document.getElementById('feeTotal');
            const feeDiscount = document.getElementById('feeDiscount');
            const feeAfterDiscount = document.getElementById('feeAfterDiscount');
            const feeNote = document.getElementById('feeNote');
            
            if (appState.admissionPath) {
                const pathNames = {
                    'new': 'ุทุงูุจ ุฌุฏูุฏ (ุจูุงููุฑููุณ)',
                    'bridging': 'ุชุฌุณูุฑ (ุฏุจููู ุฅูู ุจูุงููุฑููุณ)',
                    'postgraduate': 'ุฏุฑุงุณุงุช ุนููุง'
                };
                feePath.textContent = pathNames[appState.admissionPath];
            } else {
                feePath.textContent = 'ูู ูุญุฏุฏ ุจุนุฏ';
            }
            
            if (appState.studyType) {
                const studyTypeNames = {
                    'on-campus': 'ุญุถูุฑูุฉ',
                    'distance': 'ุนู ุจุนุฏ'
                };
                feeStudyType.textContent = studyTypeNames[appState.studyType];
            } else {
                feeStudyType.textContent = 'ูู ูุญุฏุฏ ุจุนุฏ';
            }
            
            feeHours.textContent = appState.creditHours;
            
            let hourPrice = 0;
            let discount = 0;
            
            if (appState.studyType === 'on-campus') {
                hourPrice = 2500;
            } else if (appState.studyType === 'distance') {
                hourPrice = 1500;
                discount = 0.4;
            }
            
            const totalBeforeDiscount = hourPrice * appState.creditHours;
            const discountAmount = totalBeforeDiscount * discount;
            const finalAmount = totalBeforeDiscount - discountAmount;
            
            feeHourPrice.textContent = `${hourPrice.toLocaleString()} ุฑูุงู`;
            feeTotal.textContent = `${totalBeforeDiscount.toLocaleString()} ุฑูุงู`;
            feeDiscount.textContent = `${discountAmount.toLocaleString()} ุฑูุงู`;
            
            if (appState.nationality === 'saudi' && appState.admissionPath === 'new' && appState.studyType === 'on-campus') {
                feeAfterDiscount.textContent = '0 ุฑูุงู';
                feeNote.innerHTML = '<strong>ููุงุญุธุฉ:</strong> ุงูุฏุฑุงุณุฉ ูุฏุนููุฉ ุญููููุงู ููุทูุงุจ ุงูุณุนูุฏููู ูู ุจุฑุงูุฌ ุงูุจูุงููุฑููุณ ุงูุญุถูุฑูุฉ.';
                feeNote.classList.remove('hidden');
                feeNote.classList.remove('bg-yellow-50', 'text-yellow-800', 'border-yellow-200');
                feeNote.classList.add('bg-green-50', 'text-green-800', 'border-green-200');
                appState.calculatedFees = 0;
            } else if (appState.studyType === 'distance') {
                feeAfterDiscount.textContent = `${finalAmount.toLocaleString()} ุฑูุงู`;
                feeNote.innerHTML = '<strong>ููุงุญุธุฉ:</strong> ุฎุตู 40% ูุทุจู ุนูู ุงูุฏุฑุงุณุฉ ุนู ุจุนุฏ.';
                feeNote.classList.remove('hidden');
                feeNote.classList.remove('bg-green-50', 'text-green-800', 'border-green-200');
                feeNote.classList.add('bg-yellow-50', 'text-yellow-800', 'border-yellow-200');
                appState.calculatedFees = finalAmount;
            } else if (appState.nationality === 'non-saudi' && appState.admissionPath === 'new' && appState.studyType === 'on-campus') {
                feeAfterDiscount.textContent = `${finalAmount.toLocaleString()} ุฑูุงู`;
                feeNote.innerHTML = '<strong>ููุงุญุธุฉ:</strong> ุงูุฑุณูู ูุงููุฉ ุชูุทุจู ุนูู ุงูุทูุงุจ ุบูุฑ ุงูุณุนูุฏููู.';
                feeNote.classList.remove('hidden');
                feeNote.classList.add('bg-blue-50', 'text-blue-800', 'border-blue-200');
                appState.calculatedFees = finalAmount;
            } else {
                feeAfterDiscount.textContent = `${finalAmount.toLocaleString()} ุฑูุงู`;
                appState.calculatedFees = finalAmount;
                feeNote.classList.add('hidden');
            }
        }

        // ุชุญุฏูุซ ูุณู ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ
        function updateReviewSection() {
            const pathNames = {
                'new': 'ุทุงูุจ ุฌุฏูุฏ (ุจูุงููุฑููุณ)',
                'bridging': 'ุชุฌุณูุฑ (ุฏุจููู ุฅูู ุจูุงููุฑููุณ)',
                'postgraduate': 'ุฏุฑุงุณุงุช ุนููุง'
            };
            document.getElementById('reviewPath').textContent = appState.admissionPath ? pathNames[appState.admissionPath] : '-';
            
            document.getElementById('reviewSpecialty').textContent = appState.selectedSpecialty ? appState.selectedSpecialty.name : '-';
            
            const studyTypeNames = {
                'on-campus': 'ุญุถูุฑูุฉ',
                'distance': 'ุนู ุจุนุฏ'
            };
            document.getElementById('reviewStudyType').textContent = appState.studyType ? studyTypeNames[appState.studyType] : '-';
            
            document.getElementById('reviewGPA').textContent = appState.gpa ? `${appState.gpa}%` : '-';
            document.getElementById('reviewHours').textContent = appState.creditHours ? `${appState.creditHours} ุณุงุนุฉ` : '-';
            
            document.getElementById('reviewFees').textContent = `${appState.calculatedFees.toLocaleString()} ุฑูุงู`;
        }

        // ุชุญุถูุฑ ุจูุงูุงุช ุงููููุฐุฌ ููุฅุฑุณุงู
        function prepareFormData() {
            const gpa = parseFloat(document.getElementById('gpa').value) || 0;
            const aptitude = parseFloat(document.getElementById('aptitude').value) || 0;
            const achievement = parseFloat(document.getElementById('achievement').value) || 0;
            const englishTest = document.getElementById('englishTest').value || '';
            
            let creditHours = parseInt(document.getElementById('creditHours').value) || 15;
            creditHours = Math.min(24, Math.max(12, creditHours));
            
            document.getElementById('formPath').value = appState.admissionPath;
            document.getElementById('formSpecialty').value = appState.selectedSpecialty ? appState.selectedSpecialty.name : '';
            document.getElementById('formStudyType').value = appState.studyType;
            document.getElementById('formCreditHours').value = creditHours;
            document.getElementById('formGPA').value = gpa;
            document.getElementById('formAptitude').value = aptitude;
            document.getElementById('formAchievement').value = achievement;
            document.getElementById('formEnglish').value = englishTest;
            document.getElementById('formGraduationYear').value = document.getElementById('graduationYear').value;
            document.getElementById('formCertificateType').value = document.getElementById('certificateType').value;
            document.getElementById('formFullName').value = document.getElementById('fullName').value;
            document.getElementById('formNationalId').value = document.getElementById('nationalId').value;
            document.getElementById('formEmail').value = document.getElementById('email').value;
            document.getElementById('formPhone').value = document.getElementById('phone').value;
            document.getElementById('formNationality').value = appState.nationality;
            
            if (appState.admissionPath === 'bridging') {
                document.getElementById('formDiplomaMajor').value = document.getElementById('diplomaMajor').value;
                document.getElementById('formDiplomaCertificate').value = document.getElementById('diplomaCertificate').value || 'ุณูุชู ุฑูุนู ูุงุญูุงู';
            } else {
                document.getElementById('formDiplomaMajor').value = '';
                document.getElementById('formDiplomaCertificate').value = '';
            }
        }

        // ุฏุงูุฉ ุงูุชุญูู ูู ุตุญุฉ ุฑูู ุงููููุฉ ุงููุทููุฉ ูุน ุชูุธูู ุงููุฏุฎูุงุช
        function isValidSaudiID(id) {
            const cleanedId = id.replace(/[^\d]/g, '');
            
            if (cleanedId.length !== 10) {
                return false;
            }
            
            if (!['1', '2'].includes(cleanedId.charAt(0))) {
                return false;
            }
            
            if (!/^\d+$/.test(cleanedId)) {
                return false;
            }
            
            return true;
        }

        // ุฅุฑุณุงู ุงูุทูุจ ูุน timeout ููุงุชุตุงู
        async function submitApplication() {
            if (!validateFinalSubmission()) {
                return;
            }
            
            const submitBtn = document.getElementById('submitApplication');
            const originalText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'ุฌุงุฑู ุงูุฅุฑุณุงู... <span class="animate-spin ml-2">โณ</span>';
            
            prepareFormData();
            
            try {
                const form = document.getElementById('admissionForm');
                const formData = new FormData(form);
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => {
                    controller.abort();
                    throw new Error('ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจุงูุฎุงุฏู');
                }, 15000);
                
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    body: formData,
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                const result = await response.json();
                
                if (response.status === 200 && result.success) {
                    const refNumber = 'UHB-' + Math.floor(100000 + Math.random() * 900000);
                    
                    sessionStorage.removeItem('admissionFormData');
                    
                    Swal.fire({
                        title: 'ุชู ุชูุฏูู ุทูุจู ุจูุฌุงุญ!',
                        html: `
                            <div class="text-center">
                                <div class="text-4xl md:text-6xl mb-3 md:mb-4">โ</div>
                                <p class="text-base md:text-lg mb-3 md:mb-4">ุชู ุชูุฏูู ุทูุจู ุจูุฌุงุญ! ุณูุชู ุงูุชูุงุตู ุจู ูู ูุจู ููุธู ุงูุดุคูู ุงูุฅุฏุงุฑูุฉ ูุงููุงููุฉ ูุงุณุชููุงู ุจููุฉ ุงูุฅุฌุฑุงุกุงุช ูุณุฏุงุฏ ุงูุฑุณูู ุงููุญุณูุจุฉ ูุชุฃููุฏ ุงููุจูู.</p>
                                <p class="text-lg md:text-xl font-bold text-green-700 mb-4 md:mb-6 p-2 md:p-3 bg-green-50 rounded-lg">ุฑููู ุงููุฑุฌุนู ูู: ${refNumber}</p>
                                <p class="text-sm text-gray-600">ูุฑุฌู ุญูุธ ูุฐุง ุงูุฑูู ูููุฑุงุฌุนุฉ ุงููุงุญูุฉ</p>
                            </div>
                        `,
                        icon: 'success',
                        confirmButtonText: 'ุญุณููุง',
                        confirmButtonColor: '#006837',
                        allowOutsideClick: false,
                        didClose: () => {
                            setTimeout(() => location.reload(), 1000);
                        }
                    });
                } else {
                    throw new Error(result.message || 'ูุดู ูู ุฅุฑุณุงู ุงูุทูุจ');
                }
            } catch (error) {
                console.error('Error submitting form:', error);
                
                let errorMessage = 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุทูุจู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุน ุงูุฏุนู ุงูููู.';
                
                if (error.name === 'AbortError' || error.message.includes('ูููุฉ')) {
                    errorMessage = 'ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ูุฑุฌู ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.';
                } else if (error.message.includes('network') || error.message.includes('Network')) {
                    errorMessage = 'ูุดู ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ูุฑุฌู ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.';
                }
                
                Swal.fire({
                    title: 'ุฎุทุฃ ูู ุงูุฅุฑุณุงู',
                    text: errorMessage,
                    icon: 'error',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        // ุงูุชุญูู ุงูููุงุฆู ูู ุตุญุฉ ุฌููุน ุงูุจูุงูุงุช ูุจู ุงูุฅุฑุณุงู
        function validateFinalSubmission() {
            const fullName = document.getElementById('fullName').value.trim();
            let nationalId = document.getElementById('nationalId').value;
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            
            nationalId = nationalId.replace(/[^\d]/g, '');
            document.getElementById('nationalId').value = nationalId;
            
            if (!fullName || !nationalId || !email || !phone || !appState.nationality) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ุจูุงูุงุช ูุงูุตุฉ',
                    text: 'ูุฑุฌู ุฅููุงู ุฌููุน ุงููุนูููุงุช ุงูุดุฎุตูุฉ ุงููุทููุจุฉ',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                return false;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ุจุฑูุฏ ุฅููุชุฑููู ุบูุฑ ุตุงูุญ',
                    text: 'ูุฑุฌู ุฅุฏุฎุงู ุจุฑูุฏ ุฅููุชุฑููู ุตุญูุญ',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                return false;
            }
            
            const phoneRegex = /^05\d{8}$/;
            if (!phoneRegex.test(phone)) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ุฑูู ุฌูุงู ุบูุฑ ุตุงูุญ',
                    text: 'ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุฌูุงู ุณุนูุฏู ุตุญูุญ ูุจุฏุฃ ุจู 05 ููุญุชูู ุนูู 10 ุฃุฑูุงู',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                return false;
            }
            
            if (!isValidSaudiID(nationalId)) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ุฑูู ูููุฉ ุบูุฑ ุตุงูุญ',
                    text: 'ูุฑุฌู ุฅุฏุฎุงู ุฑูู ูููุฉ ูุทููุฉ ุณุนูุฏู ุตุญูุญ (ูุจุฏุฃ ุจู 1 ุฃู 2 ููุชููู ูู 10 ุฃุฑูุงู)',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                return false;
            }
            
            if (!appState.agreementChecked) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ููุงููุฉ ูุทููุจุฉ',
                    text: 'ูุฑุฌู ุงูููุงููุฉ ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู',
                    confirmButtonText: 'ุญุณููุง',
                    confirmButtonColor: '#006837'
                });
                return false;
            }
            
            return true;
        }
    </script>
</body>
                                  </html>
